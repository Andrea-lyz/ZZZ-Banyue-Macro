# 般岳连招宏 - 绝区零 (Zenless Zone Zero)

一款专为绝区零角色「般岳」设计的 AutoHotkey v2 宏脚本，用于简化复杂的强化特殊技快速键入指令和完美取消连招操作。

## 📋 功能特点

- **一键触发强化特殊技**：将复杂的三键指令（如 AAE、EAE）简化为单键操作
- **自动怒版连招**：Z/X 键自动执行怒版强化技连招
- **完美取消连招**：侧键4 一键执行 1→2→3→4 完美取消连招
- **叫阵快捷键**：侧键5 一键触发叫阵（半圈方向键+闪避）
- **宏开关功能**：Home 键随时开关，不影响正常打字
- **网络延迟补偿**：全局延迟参数，适配正式服网络延迟

## 🎮 般岳技能机制简介

### 强化特殊技派生规则

**从启动状态派生（快速键入指令）：**
> 启动状态 = 闪避反击 / 支援突击 / 快速支援 / 连携 / 终结技 / 焚身 / 叫阵

| 指令 | 技能 | 闪能消耗 |
|------|------|----------|
| AAE | 狮子吼 | 20 |
| EAE | 论道 | 20 |
| AEA | 地动 | 20 |
| EEA | 山摇 | 20 |

**怒版强化技（需40+闪能，自动触发）：**
| 连招 | 效果 |
|------|------|
| 论道 → 快速键入 AAE | 狮子吼·怒 |
| 地动 → 快速键入 EEA | 山摇·怒 |

### 从普攻派生（无需本脚本）

| 操作 | 触发技能 |
|------|----------|
| A1/A2 + 点E | 狮子吼 |
| A3/A4 + 点E | 地动 |
| E1/E2 + 点A | 山摇 |
| E3/E4 + 点A | 论道 |

## ⌨️ 按键说明

### 控制键（全局生效）

| 按键 | 功能 |
|------|------|
| `Home` | 开启/关闭宏 |
| `Delete` | 退出脚本 |
| `PgUp` | 显示帮助 |

### 游戏按键（宏开启时生效）

| 按键 | 指令 | 技能 | 说明 |
|------|------|------|------|
| `1` | EAE | 论道 | 启动状态下使用 |
| `2` | AAE | 狮子吼 | 启动状态下使用 |
| `3` | AEA | 地动 | 启动状态下使用 |
| `4` | EEA | 山摇 | 启动状态下使用 |
| `Z` | EAE → AAE | 论道 → 狮子吼·怒 | 自动怒版连招 |
| `X` | AEA → EEA | 地动 → 山摇·怒 | 闪避反击后使用 |
| `C` | AEA → EEA | 地动 → 山摇·怒 | 完美格挡后使用（延迟不同） |
| `侧键4` | 1→2→3→4 | 完美取消连招 | 论道→狮子吼怒→地动→山摇怒 |
| `侧键5` | - | 叫阵 | 半圈方向键+闪避 |

### 怒版连招触发方式

| 方式 | 操作 | 效果 |
|------|------|------|
| 手动 | 启动状态 → `1` → `2` | 论道 → 狮子吼·怒 |
| 手动 | 启动状态 → `3` → `4` | 地动 → 山摇·怒 |
| 自动 | 启动状态 → `Z` | 论道 → 狮子吼·怒 |
| 自动 | 启动状态 → `X` | 地动 → 山摇·怒 |

## 📥 安装与使用

### 前置要求

- [AutoHotkey v2.0+](https://www.autohotkey.com/download/)

### 使用步骤

1. 安装 AutoHotkey v2.0 或更高版本
2. 右键 `般岳.ahk`以管理员权限运行脚本
3. 托盘区会出现 AHK 图标，显示"般岳宏已启动"
4. 进入游戏，切换到般岳角色即可使用

### 关闭脚本

- 按 `Delete` 键退出
- 或右键托盘图标 → Exit

## ⚙️ 参数调整

### 网络延迟补偿

如果在正式服使用时感觉延迟不对，修改脚本中的：

```ahk
global GlobalLatency := 0         ; 增加此值以补偿网络延迟，单位ms
```

### 各连招延迟（可单独调整）

```ahk
global ZKeyDelay := 950           ; Z键: 论道→狮子吼·怒
global XKeyDelay := 1450          ; X键: 地动→山摇·怒 (闪避反击后)
global ParryXDelay := 1750        ; C键: 地动→山摇·怒 (完美格挡后)

global Side4Delay1 := 500         ; 侧键4: 论道→狮子吼
global Side4Delay2 := 800         ; 侧键4: 狮子吼→地动
global Side4Delay3 := 1400        ; 侧键4: 地动→山摇
```

### 按键映射

如果游戏内按键设置不同，修改：

```ahk
global KeyAttack := "LButton"     ; 普攻
global KeyDodge := "RButton"      ; 闪避
global KeySpecial := "e"          ; 强化/特殊技
```

## 🔧 常见问题

### Q: 宏不生效？

1. 确认 AHK 已管理员权限运行并且图标在托盘区
2. 按 `Home` 确认宏已开启
3. 确认游戏窗口处于激活状态
4. 确认游戏进程名为 `ZenlessZoneZero.exe` 或 `ZenlessZoneZeroBeta.exe`

### Q: 连招触发不稳定？

1. 检查是否处于"启动状态"（闪避反击/不动如山等）
2. 调整对应的延迟参数
3. 正式服可能需要增加 `GlobalLatency`

### Q: 怒版只触发普通版？

- 确保闪能 ≥ 40 点
- 调整对应的延迟参数（可能需要增加）

### Q: 完美取消成功率低？

- 完美取消有固定窗口期，可微调各延迟参数
- 地动→山摇的完美取消窗口较晚，延迟需要更大

## ⚠️ 免责声明

本脚本仅供学习交流使用。使用游戏宏可能违反游戏用户协议，请自行承担风险。

## 📝 更新日志

### v1.0
- 初始版本
- 支持 1-4 键快速键入强化特殊技
- 支持 Z/X/C 键自动怒版连招
- 支持侧键4 完美取消连招
- 支持侧键5 叫阵
- 支持 Home 键开关宏
- 支持全局延迟补偿
