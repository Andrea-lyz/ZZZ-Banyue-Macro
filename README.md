# 般岳连招宏 v4.0 - 绝区零 (Zenless Zone Zero)

一款专为绝区零角色「般岳」设计的 AutoHotkey v2 宏脚本。v4 版本在 v3 的基础上进行了**代码重构与性能优化**，重新梳理了脚本结构，优化了连招间隔，并清理了冗余代码，使运行更加稳定流畅。

## 🌟 核心特性

- **双模式系统**：提供「连招模式」与「搓招模式」，分别针对最大化伤害倍率和高上限自由操作，一键切换。
- **可视化按键悬浮窗**：实时显示物理按键操作（1234/QE/Shift/Space/鼠标键），支持拖动和快捷开关 (`Ctrl+PgUp`)，方便演示与教学。
- **智能状态提示**：GUI 实时显示当前连招详情、伤害倍率、前置条件及完美时机建议，搓招模式下还能智能提示连携派生。
- **连招中断机制**：支持通过 Shift/Space/Q/C/右键 等操作立即中断当前宏运行，确保实战灵活性。
- **高性能与低延迟**：经过优化的代码结构与按键间隔配置，确保连招触发稳定流畅，并支持自定义网络延迟补偿。
- **完善的连招库**：内置经过计算的最优倍率连招（如地动起手四连、论道起手四连等），并适配怒相爆发循环。

## 🎮 模式说明

### 1. 连招模式 (Combo Mode) - 默认

**目标**：以保软弱为优先，最大化伤害倍率，简化操作，适合打桩或确定安全的输出窗口。

| 按键 | 功能 | 说明 |
|------|------|------|
| `1` | **连招1** | AAA/AAAA启动 → 地动 → 山摇·怒 → 狮子吼<br>*(闪能不足时的最优短轴爆发)* |
| `2` | **连招2** | 闪反/不动如山A → 地动 → 山摇·怒 → 论道 → 狮子吼·怒<br>*(山摇怒优先，总倍率 2086%)* |
| `3` | **连招3** | 闪反/不动如山A → 论道 → 狮子吼·怒 → 地动 → 山摇·怒<br>*(狮子吼怒优先，总倍率 2086%)* |
| `4` | - | 此模式下禁用 |

### 2. 搓招模式 (Manual Mode)

**目标**：提高操作上限，自由组合技能，适合需要灵活应对的实战，要求一定熟练度。

| 按键 | 对应技能 | 指令（粗体为预输入提示） |
|------|----------|------|
| `1` | **狮子吼** | AAE |
| `2` | **论道** | EAE |
| `3` | **山摇** | EEA |
| `4` | **地动** | AEA |
| `1→2→1` | **狮子吼•怒** | AAE**EA**E**AA**E |
| `1→4→3` | **山摇•怒** | AAE**AE**A**EE**A |

## ⌨️ 全局按键

| 按键 | 功能 |
|------|------|
| `Home` | 开启/关闭宏 |
| `PgDn` | **切换 搓招/连招 模式** |
| `PgUp` | 显示帮助窗口 |
| `Ctrl+PgUp` | **开启/关闭按键显示悬浮窗** |
| `Delete` | 退出脚本 |
| `侧键4` | **怒相爆发循环** (狮子吼起手 → 4山威消耗)<br>狮子吼 → 地动 → 山摇·怒 → 论道 |
| `侧键5` | **叫阵** (半圈方向键 + 闪避) |

## ⚙️ 参数配置

脚本头部包含可调整的全局变量，适配不同网络环境和手感：

```ahk
; === 网络延迟补偿 ===
global GlobalLatency := 0         ; 全局延迟补偿(ms)，正式服有延迟时增加此值

; === 连招延迟微调 ===
global Side4Delay1 := 100         ; 狮子吼→地动
global Side4Delay2 := 1100        ; 地动→山摇·怒
global Side4Delay3 := 500         ; 山摇·怒→论道
```

## ❓ 常见问题

### Q: 按键悬浮窗不显示？

- 默认启动时悬浮窗是关闭的。请按下 `Ctrl+PgUp` 开启。

### Q: 宏不生效？

1. 确认 AHK 已管理员权限运行并且图标在托盘区
2. 按 `Home` 确认宏已开启
3. 确认游戏窗口处于激活状态
4. 确认游戏进程名为 `ZenlessZoneZero.exe` 或 `ZenlessZoneZeroBeta.exe`

### Q: 连招触发不稳定？

1. 检查是否处于"启动状态"（闪避反击/不动如山等）
2. 调整对应的延迟参数
3. 正式服可能需要增加 `GlobalLatency`

## ⚠️ 免责声明

本脚本仅供学习交流使用。使用游戏宏可能违反游戏用户协议，请自行承担风险。

## 📝 更新日志 (Changelog)

### v4.0 (Latest)

- **[重构]** 脚本结构全面优化，模块化分层（全局变量/核心函数/初始化/热键）。
- **[优化]** 连招模式按键间隔调整为 80ms，提升稳定性。
- **[优化]** 优化连招模式下部分技能间延迟，提升连招稳定性。
- **[清理]** 移除冗余变量与过时注释。
- **[文档]** 更新 README 与代码注释。

### v3.0

- **[新增]** 可视化按键显示 GUI，支持拖动和开关 (`Ctrl+PgUp`)。
- **[新增]** 实时状态文本提示，显示连招详情和完美时机。
- **[优化]** 搓招模式下支持连携派生提示 (2→1, 4→3)。
- **[优化]** 帮助界面关闭按钮修复。
- **[调整]** 延迟参数微调，适配最新手感。
- **[修复]** 修复了连招中断功能在使用后再切换模式时导致报错的问题。

### v2.0

- **[新增]** 双模式系统：通过 `PgDn` 切换「搓招模式」与「连招模式」。
- **[优化]** 侧键4 连招逻辑：更新为「狮子吼起手」的4连循环，完美适配怒相模式4点山威限制，总倍率提升至约 1794%。
- **[新增]** 连招中断功能：执行宏期间按下 Shift/Space/RButton/Q/C 可立即停止宏运行。
- **[重构]** 键位布局：
  - 连招模式下，1/2/3 键替代了原有的 Z/X/C 键功能。
  - 搓招模式下，1-4 键重新映射为 狮子吼/论道/山摇/地动。
- **[移除]** 移除了独立的 Z/X/C 键位绑定，整合至连招模式。
- **[优化]** 帮助界面 (`PgUp`) 更新为 GUI 窗口，信息更清晰。

### v1.0

- 初始版本发布。
- 支持 1-4 键快速键入强化特殊技 (AAE/EAE/AEA/EEA)。
- 支持 Z/X/C 键触发特定怒版连招。
- 支持侧键4 完美取消连招 (旧版逻辑)。
- 支持侧键5 一键叫阵。
