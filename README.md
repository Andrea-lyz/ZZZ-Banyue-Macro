# 般岳连招宏 v5.0 - 绝区零 (Zenless Zone Zero)

一款专为绝区零角色「般岳」设计的 AutoHotkey v2 宏脚本。本脚本通过精准的按键时序控制，帮助玩家一键打出“完美取消”的高倍率连招。集成了可视化按键悬浮窗与实时状态提示，支持灵活的连招中断与模式切换，全面适配长短轴爆发、聚怪及怒相转换等多种实战场景。

## 🌟 核心特性

- **双模式系统**：提供「连招模式」与「搓招模式」，分别针对最大化伤害倍率和高上限自由操作，一键切换。
- **可视化按键悬浮窗**：实时显示物理按键操作（1234/QE/Shift/Space/鼠标键），支持拖动和快捷开关 (`Ctrl+PgUp`)，方便演示与教学。
- **智能状态提示**：GUI 实时显示当前连招详情、伤害倍率、前置条件及完美时机建议，搓招模式下还能智能提示连携派生。
- **连招中断机制**：支持通过 Shift/Space/Q/C/右键 等操作立即中断当前宏运行，确保实战灵活性。
- **高性能与低延迟**：经过优化的代码结构与按键间隔配置，叫阵功能升级为极速 `SendInput`，延迟降至毫秒级。
- **完善的连招库**：内置经过计算的最优倍率连招（如地动起手四连、论道起手四连等），并适配怒相爆发循环。
- **丰富的短轴爆发**：v5 新增了两套针对闪能不足时的短轴连招（Key 1/2）以及怒相下的瞬山爆发（Key X）。

## 🎮 模式说明

### 1. 连招模式 (Combo Mode) - 默认

**目标**：以保软弱为优先，最大化伤害倍率，简化操作，适合打桩或确定安全的输出窗口。

| 按键 | 功能 | 说明 |
|------|------|------|
| `1` | **连招1** | **地动 → 山摇·怒 → 狮子吼**<br>前置: "手动3A/4A"或"金身格挡反击/闪反/闪反叫阵长按A"+点按A接峥嵘3A后<br>*(闪能不足时的最优短轴输出爆发)* |
| `2` | **连招2** | **论道 → 狮子吼·怒 → 山摇**<br>前置: "手动3E/4E"或"金身格挡反击/闪反/闪反叫阵长按A"+点按E接崔巍3E后<br>*(闪能不足时的最优短轴聚怪爆发)* |
| `3` | **连招3** | **地动 → 山摇·怒 → 论道 → 狮子吼·怒**<br>前置: 闪反/不动如山A后<br>*(山摇怒优先，最高总倍率 2086%)* |
| `4` | **连招4** | **论道 → 狮子吼·怒 → 地动 → 山摇·怒**<br>前置: 闪反/不动如山A后<br>*(狮子吼怒优先，怒相状态下不建议用，容易触发摧山)* |
| `X` | **怒吼瞬山** | **论道 → 狮子吼·怒 → 蓄力A**<br>前置: "手动3E/4E"或"金身格挡反击/闪反/闪反叫阵长按A"+点按E触发崔巍3E后<br>*(怒相中打失衡前用，类似仪玄瞬大)* |

### 2. 搓招模式 (Manual Mode)

**目标**：提高操作上限，自由组合技能，适合需要灵活应对的实战，要求一定熟练度。

| 按键 | 对应技能 | 指令（粗体为预输入提示） |
|------|----------|------|
| `1` | **狮子吼** | AAE |
| `2` | **论道** | EAE |
| `3` | **山摇** | EEA |
| `4` | **地动** | AEA |
| `1→2→1` | **狮子吼•怒** | AAE**EA**E**AA**E |
| `1→4→3` | **山摇•怒** | AAE**AE**A**EE**A |

## ⌨️ 全局按键

| 按键 | 功能 |
|------|------|
| `Home` | 开启/关闭宏 |
| `PgDn` | **切换 搓招/连招 模式** |
| `PgUp` | 显示帮助窗口 |
| `Ctrl+PgUp` | **开启/关闭按键显示悬浮窗** |
| `Delete` | 退出脚本 |
| `侧键4` | **4山威2怒爆发** 一键进入怒相消耗4山威完美取消2怒爆发 |
| `侧键5` | **叫阵** (极速 WAS + 闪避) |

## ⚙️ 参数配置

脚本头部包含可调整的全局变量，适配不同网络环境和手感：

```ahk
; === 网络延迟补偿 ===
global GlobalLatency := 0         ; 全局延迟补偿(ms)，可填负值。正值=增加延迟(慢)，负值=减少延迟(快)。例: -20

; === 连招延迟微调 ===
global Side4Delay1 := 100         ; 狮子吼→地动
global Side4Delay2 := 1100        ; 地动→山摇·怒
global Side4Delay3 := 500         ; 山摇·怒→论道
```

## ❓ 常见问题

### Q: 按键悬浮窗不显示？

- 默认启动时悬浮窗是关闭的。请按下 `Ctrl+PgUp` 开启。

### Q: 宏不生效？

1. 确认 AHK 已管理员权限运行并且图标在托盘区
2. 按 `Home` 确认宏已开启
3. 确认游戏窗口处于激活状态
4. 确认游戏进程名为 `ZenlessZoneZero.exe` 或 `ZenlessZoneZeroBeta.exe`

### Q: 连招触发不稳定？

1. 检查是否处于"启动状态"（闪避反击/不动如山等）
2. 调整对应的延迟参数
3. 正式服可能需要增减 `GlobalLatency`

## ⚠️ 免责声明

本脚本仅供学习交流使用。使用游戏宏可能违反游戏用户协议，请自行承担风险。

## 📝 更新日志 (Changelog)

### v5.0 (Latest)

### v5.0 (Latest)

- **[新增]** 连招模式新增 **Key 2** 连招 (前置 → 论道 → 狮子吼·怒 → 山摇)，适配短轴聚怪爆发。
- **[新增]** 连招模式新增 **X** 键连招 (论道 → 狮子吼·怒 → 蓄力A)，怒相转场类似仪玄瞬大的操作。
- **[改动]** 连招模式 **Key 1** 优化逻辑为前置 → 地动 → 山摇·怒 → 狮子吼 (输出三连)。
- **[调整]** 原 Key 2 (地动起手四连) 键位移至 **Key 3**，并微调了延迟参数（完美取消）。
- **[调整]** 原 Key 3 (论道起手四连) 键位移至 **Key 4**。
- **[优化]** **侧键4** 逻辑重构为：一键进入怒相消耗4山威完美取消2怒爆发。
- **[优化]** **叫阵 (侧键5)** 底层升级为 `SendInput` 模式，极大降低了触发延迟。
- **[优化]** 帮助 GUI 新增 Toggle 功能（再次按 PgUp 关闭），并修复了状态显示 Bug。
- **[优化]** 优化了按键映射悬浮窗的UI显示。
- **[文档]** 全面更新了脚本内的状态提示文本，更清晰地标注了前置条件。

### v4.0

- **[重构]** 脚本结构全面优化，模块化分层（全局变量/核心函数/初始化/热键）。
- **[优化]** 连招模式按键间隔调整为 80ms，提升稳定性。
- **[优化]** 优化连招模式下部分技能间延迟，提升连招稳定性。
- **[清理]** 移除冗余变量与过时注释。
- **[文档]** 更新 README 与代码注释。

### v3.0

- **[新增]** 可视化按键显示 GUI，支持拖动和开关 (`Ctrl+PgUp`)。
- **[新增]** 实时状态文本提示，显示连招详情和完美时机。
- **[优化]** 搓招模式下支持连携派生提示 (2→1, 4→3)。
- **[优化]** 帮助界面关闭按钮修复。
- **[调整]** 延迟参数微调，适配最新手感。
- **[修复]** 修复了连招中断功能在使用后再切换模式时导致报错的问题。

### v2.0

- **[新增]** 双模式系统：通过 `PgDn` 切换「搓招模式」与「连招模式」。
- **[优化]** 侧键4 连招逻辑：更新为「狮子吼起手」的4连循环，完美适配怒相模式4点山威限制，总倍率提升至约 1794%。
- **[新增]** 连招中断功能：执行宏期间按下 Shift/Space/RButton/Q/C 可立即停止宏运行。
- **[重构]** 键位布局：
  - 连招模式下，1/2/3 键替代了原有的 Z/X/C 键功能。
  - 搓招模式下，1-4 键重新映射为 狮子吼/论道/山摇/地动。
- **[移除]** 移除了独立的 Z/X/C 键位绑定，整合至连招模式。
- **[优化]** 帮助界面 (`PgUp`) 更新为 GUI 窗口，信息更清晰。

### v1.0

- 初始版本发布。
- 支持 1-4 键快速键入强化特殊技 (AAE/EAE/AEA/EEA)。
- 支持 Z/X/C 键触发特定怒版连招。
- 支持侧键4 完美取消连招 (旧版逻辑)。
- 支持侧键5 一键叫阵。
